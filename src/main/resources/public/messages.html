<html>
<head>
    <script type="text/javascript" src="http://code.jquery.com/jquery-1.7.1.min.js"></script>

    <title></title>
    <link rel="stylesheet" type="text/css" href="stylesheets/messages.css">
</head>
<body>
    <div id="header">
        <center><ul>
            <li class="nav" id="navleft">
                <em><h3>space 'n' shit</h3></em>
            </li>
            <li class="nav" id="navimg">
                <img src="http://i60.tinypic.com/mwza5t.gif" height="32" width="32" style="margin-top: 20px;">
            </li>
            <li class="nav" id="navright">
                <em><h5>
                    <a href="index.html">Sign out my man</a>
                </h5></em>
            </li>
        </ul></center>
    </div>
    <div id="main_div" >
        <div id="messages_title" >
            <em><h1>Chat 'n' stuff ;)</h1></em>
        </div>
        <div id="messagesDiv">
            <div id="messagethingy">

            </div>
        </div>
        <div>
            <input type="text" id="message-text" placeholder="After reading the dictionary, every book is a remix"/>
            <button id="buttonthing" onclick="loadscript(), loadMessages()">SEND</button>
        </div>
    </div>


    <script>
        function loadscript(){

            var myObj = {};
            myObj["message"] = $("#message-text").val();
            var json = JSON.stringify(myObj);

            $.ajax({
                type: "POST",
                url: "/message",
                data: json,
                success: null,
                dataType: "json",
                contentType: "application/json; charset=utf-8"
            });
        }
    </script>

    <script>
        function printMessages(data){
            $.each(data, function(index, message){
                $("#messagethingy").append("<br> " + message.text)
            })
        }

        function loadMessages(){
            $.ajax({
                type: "GET",
                url: "/message",
                data: null,
                success: function (data) {
                    printMessages(data);
                },
                dataType: "json",
                contentType: "application/json; charset=utf-8"
            });
            $( "#messagethingy" ).empty();
        }

        window.onload = function () {
            loadMessages();
        }
    </script>
</body>
</html>