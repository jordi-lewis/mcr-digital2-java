
<html>
<head>
    <script type="text/javascript" src="http://code.jquery.com/jquery-1.7.1.min.js"></script>

    <title></title>
    <link rel="stylesheet" type="text/css" href="stylesheets/messages.css">
</head>
<body>
    <div class="login-page" id="login_box">
        <div id="main_div" >
            <div id="messages_title" >
                <em><h1>Chat 'n' stuff ;)</h1></em>
            </div>
            <div id="messagesDiv">
                <div id="messagethingy">

                </div>
            </div>
            <div>
                <input type="text" id="message-text" placeholder="After reading the dictionary, every book is a remix"/>
                <button id="buttonthing" onclick="loadscript()">SEND</button>
            </div>
        </div>
    </div>

    <script>
        function loadscript(){

            var myObj = {};
            myObj["message"] = $("#message-text").val();
            var json = JSON.stringify(myObj);

            $.ajax({
                type: "POST",
                url: "/message",
                data: json,
                success: function(){
                    loadMessages();
                },
                dataType: "json",
                contentType: "application/json; charset=utf-8"
            });
        }
    </script>

    <script>
        function printMessages(data){
            $.each(data, function(index, message){
                $("#messagethingy").append("<br> " + message.text)
            })
        }

        function loadMessages(){
            $.ajax({
                type: "GET",
                url: "/message",
                data: null,
                success: function (data) {
                    printMessages(data);
                },
                dataType: "json",
                contentType: "application/json; charset=utf-8"
            });
            $( "#messagethingy" ).empty();
        }

        window.onload = function () {
            loadMessages();
        }
    </script>
</body>
</html>